apply plugin: 'war'
apply plugin: 'idea'

defaultTasks 'clean', 'build'

repositories {
  mavenCentral()
}

configurations.all {
  exclude(group: 'commons-logging')
}

dependencies {
  providedCompile 'javax.servlet:servlet-api:2.5'
}

task wrapper(type: Wrapper) {
  gradleVersion = '1.0'
}

task init << {
  [
    file('src/main/java'),
    file('src/main/resources'),
    file('src/main/webapp/WEB-INF'),
    file('src/test/java'),
    file('src/test/resources'),
  ].each { dir -> if (!dir.exists()) { dir.mkdirs() } }

  def webxml = file('src/main/webapp/WEB-INF/web.xml')
  def webapp = '<?xml version="1.0" encoding="UTF-8"?>\n' +
    '<web-app xmlns="http://java.sun.com/xml/ns/javaee"\n' +
    '         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n' +
    '         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"\n' +
    '         version="2.5">\n' +
    '</web-app>\n'
  if (!webxml.exists()) { webxml.write(webapp, 'UTF-8') }
}
